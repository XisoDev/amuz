webpackJsonp([2],{220:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(4),i=a(r),s=n(12),o=a(s),l=n(72),d=a(l);$(function(){var e=$("#menuContainer");o.default.render(i.default.createElement(d.default,{baseUrl:e.data("url"),home:e.data("home"),menus:e.data("menus"),menuRoutes:{createMenu:e.data("createmenu")}},null),e[0])})},26:function(e,t,n){"use strict";function a(e){return e}function r(e,t,n){function r(e,t){var n=v.hasOwnProperty(t)?v[t]:null;S.hasOwnProperty(t)&&o("OVERRIDE_BASE"===n,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t),e&&o("DEFINE_MANY"===n||"DEFINE_MANY_MERGED"===n,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function d(e,n){if(n){o("function"!=typeof n,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),o(!t(n),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var a=e.prototype,i=a.__reactAutoBindPairs;n.hasOwnProperty(l)&&N.mixins(e,n.mixins);for(var s in n)if(n.hasOwnProperty(s)&&s!==l){var d=n[s],u=a.hasOwnProperty(s);if(r(u,s),N.hasOwnProperty(s))N[s](e,d);else{var c=v.hasOwnProperty(s),h="function"==typeof d,m=h&&!c&&!u&&!1!==n.autobind;if(m)i.push(s,d),a[s]=d;else if(u){var g=v[s];o(c&&("DEFINE_MANY_MERGED"===g||"DEFINE_MANY"===g),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",g,s),"DEFINE_MANY_MERGED"===g?a[s]=p(a[s],d):"DEFINE_MANY"===g&&(a[s]=f(a[s],d))}else a[s]=d}}}else;}function u(e,t){if(t)for(var n in t){var a=t[n];if(t.hasOwnProperty(n)){var r=n in N;o(!r,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',n);var i=n in e;o(!i,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",n),e[n]=a}}}function c(e,t){o(e&&t&&"object"==typeof e&&"object"==typeof t,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects.");for(var n in t)t.hasOwnProperty(n)&&(o(void 0===e[n],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",n),e[n]=t[n]);return e}function p(e,t){return function(){var n=e.apply(this,arguments),a=t.apply(this,arguments);if(null==n)return a;if(null==a)return n;var r={};return c(r,n),c(r,a),r}}function f(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function h(e,t){var n=t.bind(e);return n}function m(e){for(var t=e.__reactAutoBindPairs,n=0;n<t.length;n+=2){var a=t[n],r=t[n+1];e[a]=h(e,r)}}function g(e){var t=a(function(e,a,r){this.__reactAutoBindPairs.length&&m(this),this.props=e,this.context=a,this.refs=s,this.updater=r||n,this.state=null;var i=this.getInitialState?this.getInitialState():null;o("object"==typeof i&&!Array.isArray(i),"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent"),this.state=i});t.prototype=new x,t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],y.forEach(d.bind(null,t)),d(t,E),d(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),o(t.prototype.render,"createClass(...): Class specification must implement a `render` method.");for(var r in v)t.prototype[r]||(t.prototype[r]=null);return t}var y=[],v={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},N={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)d(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=i({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=i({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=p(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=i({},e.propTypes,t)},statics:function(e,t){u(e,t)},autobind:function(){}},E={componentDidMount:function(){this.__isMounted=!0},componentWillUnmount:function(){this.__isMounted=!1}},S={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e,t)},isMounted:function(){return!!this.__isMounted}},x=function(){};return i(x.prototype,e.prototype,S),g}var i=n(27),s=n(17),o=n(1),l="mixins";e.exports=r},27:function(e,t,n){"use strict";function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,o,l=a(e),d=1;d<arguments.length;d++){n=Object(arguments[d]);for(var u in n)i.call(n,u)&&(l[u]=n[u]);if(r){o=r(n);for(var c=0;c<o.length;c++)s.call(n,o[c])&&(l[o[c]]=n[o[c]])}}return l}},343:function(e,t,n){n(220),n(68),n(69),n(73),n(74),n(70),n(71),e.exports=n(72)},45:function(e,t,n){"use strict";var a=n(11),r=n(1),i=n(46);e.exports=function(){function e(e,t,n,a,s,o){o!==i&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return n.checkPropTypes=a,n.PropTypes=n,n}},68:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(9),d=a(l);t.default=(0,o.default)({displayName:"MenuEntity",propTypes:{index:d.default.object,onCollapse:d.default.func,getBaseUrl:d.default.func},handleCollapse:function(e){e.stopPropagation();var t=this.props.index.id;this.props.onCollapse&&this.props.onCollapse(t)},render:function(){var e=this.props.index,t=e.node,n=this.props.getBaseUrl()+"/menus/"+t.id,a=this.props.getBaseUrl()+"/menus/"+t.id+"/types",r={addItem:XE.Lang.trans("xe::addItem")},s="xe_tree_node_"+t.id;return i.default.createElement("div",{className:"panel-heading",id:s},i.default.createElement("div",{className:"pull-left"},i.default.createElement("a",{href:n},i.default.createElement("h3",null,i.default.createElement("i",{className:"xi-folder"}),t.title))),i.default.createElement("div",{className:"pull-right"},i.default.createElement("a",{href:a,className:"btn btn-primary"},i.default.createElement("i",{className:"xi-plus"}),i.default.createElement("span",null,r.addItem))))}})},69:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(12),d=a(l),u=n(9),c=a(u);t.default=(0,o.default)({displayName:"MenuItem",propTypes:{index:c.default.object,home:c.default.string,getBaseUrl:c.default.func,clickHome:c.default.func,mouseDown:c.default.func,getSelectedNode:c.default.func,setSelectedNode:c.default.func},onClickLink:function(e){"xpressengine@directLink"!==e.type?location.href="/"+e.url:location.href=e.url},componentDidUpdate:function(){var e=this.props.getSearchedNode(),t=this.props.index.node;e===t&&($("html, body").animate({scrollTop:$("#xe_tree_node_"+t.id).offset().top-20},500),this.props.setSearchedNode(null))},onClickHome:function(e){this.props.clickHome(e)},handleMouseDown:function(e){var t=this.props.index.id,n=d.default.findDOMNode(this.refs.inner);this.props.mouseDown(t,n,e)},onClickSetNode:function(e){this.props.getSelectedNode()===e?this.props.setSelectedNode(null):this.props.setSelectedNode(e)},render:function(){var e=this.props.index.node,t=e.title||"",n=e.type,a="",r={title:XE.Lang.trans(t),setHome:XE.Lang.trans("xe::setHome"),goLink:XE.Lang.trans("xe::goLink")};"xpressengine@directLink"!==e.type?(a=e.id==this.props.home?"/":"/"+e.url,a=Utils.getUri(xeBaseURL+a)):a=e.url;var s,o=this.props.getBaseUrl()+"/menus/"+e.menuId+"/items/"+e.id;s=e.id==this.props.home?i.default.createElement("button",{type:"button",className:"btn-link hidden-xs home-on"},i.default.createElement("i",{className:"xi-home"})):1===e.activated?i.default.createElement("button",{type:"button",className:"btn btn-link hidden-xs",onClick:this.onClickHome.bind(null,e)},i.default.createElement("i",{className:"xi-home"})):null;var l;this.props.getSelectedNode()==e&&(l=i.default.createElement("div",{className:"visible-xs more-area",style:{display:"block"}},i.default.createElement("button",{className:"btn",type:"button",onClick:this.onClickHome.bind(null,e)},r.setHome),i.default.createElement("a",{href:a,className:"btn"},r.goLink)));var d="xe_tree_node_"+e.id;return i.default.createElement("div",{className:"item-content",ref:"inner",id:d},i.default.createElement("button",{className:"btn handler",onMouseDown:this.handleMouseDown},i.default.createElement("i",{className:"xi-drag-vertical"})),i.default.createElement("div",{className:"item-info"},i.default.createElement("i",{className:"xi-paper"}),i.default.createElement("dl",null,i.default.createElement("dt",{className:"sr-only"},r.title),i.default.createElement("dd",{className:"ellipsis"},i.default.createElement("a",{href:o},r.title)),i.default.createElement("dt",{className:"sr-only"},a),i.default.createElement("dd",{className:"text-blue ellipsis"},i.default.createElement("a",{href:a},a),i.default.createElement("em",null,"[",n,"]")))),i.default.createElement("div",{className:"btn-group pull-right"},i.default.createElement("button",{type:"button",className:"btn-more visible-xs",onClick:this.onClickSetNode.bind(null,e)},i.default.createElement("i",{className:"xi-ellipsis-v"})),s),l)}})},7:function(e,t,n){"use strict";var a=n(4),r=n(26),i=(new a.Component).updater;e.exports=r(a.Component,a.isValidElement,i)},70:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(12),o=a(s),l=n(7),d=a(l),u=n(9),c=a(u),p=n(71),f=a(p);t.default=(0,d.default)({displayName:"MenuSearchBar",propTypes:{tree:c.default.object,placeholder:c.default.string,handleSearch:c.default.func,menuRoutes:c.default.object},getDefaultProps:function(){return{placeholder:"Search...",tree:new Tree({})}},componentDidMount:function(){},getInitialState:function(){return{query:"",suggestions:[],selectedIndex:-1,selectionMode:!1,searchingCnt:0}},handleChange:function(e){var t=e.target.value.trim();this.setState({query:t}),this.searchMenu(t),0==t.length&&this.setState({suggestions:[],searchingCnt:0})},searchMenu:function(e){var t,n=this,a=this.state.searchingCnt+1,r=this.props.tree;this.setState({searchingCnt:a}),t=_.filter(r.indexes,function(t){if(0==t.id)return!1;var a=t.node.title;return n.isMenuEntity(t.node)||(a=XE.Lang.trans(t.node.title)),!(!a||-1===a.indexOf(e))}),a=this.state.searchingCnt,a-=1,n.setState({suggestions:t,searchingCnt:a})},isMenuEntity:function(e){return e.entity&&"menu"==e.entity},resetSearch:function(){var e=o.default.findDOMNode(this.refs.input);this.setState({query:"",selectedIndex:-1,selectionMode:!1,suggestions:[]}),e.value="",e.focus()},handleKeyDown:function(e){var t=this.state,n=t.query,a=t.selectedIndex,r=t.suggestions;e.keyCode===Keys.ESCAPE&&(e.preventDefault(),this.resetSearch()),e.keyCode!==Keys.ENTER&&e.keyCode!==Keys.TAB||""==n||(e.preventDefault(),this.state.selectionMode&&this.selection(this.state.suggestions[this.state.selectedIndex])),e.keyCode===Keys.UP_ARROW&&(e.preventDefault(),a<=0?this.setState({selectedIndex:this.state.suggestions.length-1,selectionMode:!0}):this.setState({selectedIndex:a-1,selectionMode:!0})),e.keyCode===Keys.DOWN_ARROW&&(e.preventDefault(),this.setState({selectedIndex:(this.state.selectedIndex+1)%r.length,selectionMode:!0}))},selection:function(e){var t=o.default.findDOMNode(this.refs.input);this.props.handleSearch(e.node),this.setState({query:"",selectionMode:!1,selectedIndex:-1}),t.value="",t.focus()},handleSuggestionClick:function(e,t){t.preventDefault(),this.selection(this.state.suggestions[e])},handleSuggestionHover:function(e,t){this.setState({selectedIndex:e,selectionMode:!0})},render:function(){var e=this.state.query.trim(),t=this.state.selectedIndex,n=this.state.suggestions,a=this.props.placeholder,r={addMenu:XE.Lang.trans("xe::addMenu")};return i.default.createElement("div",{className:"panel-heading"},i.default.createElement("div",{className:"pull-left"},i.default.createElement("div",{className:cx({"input-group":!0,"search-group":!0,open:e.length>0})},i.default.createElement("input",{type:"text",className:"form-control","aria-label":"Text input with dropdown button",placeholder:a,ref:"input",onChange:this.handleChange,onKeyDown:this.handleKeyDown}),i.default.createElement("button",{className:"btn-link",onClick:this.resetSearch},i.default.createElement("i",{className:"xi-search"}),i.default.createElement("span",{className:"sr-only"},"검색")),i.default.createElement(f.default,{query:e,suggestions:n,selectedIndex:t,handleClick:this.handleSuggestionClick,handleHover:this.handleSuggestionHover}))),i.default.createElement("div",{className:"pull-right"},i.default.createElement("a",{href:this.props.menuRoutes.createMenu,className:"btn btn-primary pull-right"},i.default.createElement("i",{className:"xi-plus"})," ",r.addMenu)))}})},71:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(9),d=a(l);t.default=(0,o.default)({displayName:"MenuSearchSuggestion",propTypes:{query:d.default.string.isRequired,handleClick:d.default.func.isRequired,handleHover:d.default.func.isRequired,searchingCnt:d.default.number,suggestions:d.default.array,selectedIndex:d.default.number},markIt:function(e,t){var n=t.trim().replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),a=RegExp(n,"gi"),r=e.node.title;return this.isMenuEntity(e.node)||(r=XE.Lang.trans(e.node.title)),{__html:r.replace(a,"<em>$&</em>")}},isMenuEntity:function(e){return e.entity&&"menu"==e.entity},render:function(){var e=this.props,t=this.props.suggestions.map(function(t,n){return i.default.createElement("li",{key:n,onClick:e.handleClick.bind(null,n),onMouseOver:e.handleHover.bind(null,n),className:cx({on:n==e.selectedIndex})},i.default.createElement("a",{href:"#",dangerouslySetInnerHTML:this.markIt(t,e.query)}))}.bind(this));return t&&0===t.length||e.query.length<2?i.default.createElement("div",{className:"search-list"}):i.default.createElement("div",{className:"search-list"},i.default.createElement("ul",null,t))}})},72:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(70),d=a(l),u=n(74),c=a(u);t.default=(0,o.default)({getInitialState:function(){return{rawTree:this.props.menus,dataTree:new Tree({title:"root",items:this.props.menus}),selected:null,searched:null,home:this.props.home,menuRoutes:this.props.menuRoutes}},componentDidMount:function(){this.state.dataTree.movementFilter=this.movementFilter},getSearchedNode:function(){return this.state.searched},setSearchedNode:function(e){this.setState({searched:e})},getSelectedNode:function(){return this.state.selected},setSelectedNode:function(e){this.setState({selected:e})},movementFilter:function(e){var t=e.tree,n=t.get(e.toId),a=t.getIndex(e.toId),r=t.get(e.fromId);if(!this.isMenuEntity(r)){if(this.isMenuEntity(n)){if("after"==e.placement)return e.placement="prepend",e;if("before"==e.placement){if(a.prev&&null!=a.prev){var i=t.getIndex(a.prev);return e.toId=a.prev,i.collapsed||(e.placement="append"),e}return}return e}if("append"!=e.placement&&"prepend"!=e.placement||!(a.depth>MaxDepth))return e}},moveMenuItem:function(e){var t=this.props.baseUrl+"/moveItem",n=$("#uitree");XE.ajax({url:t,context:n,type:"put",dataType:"json",data:{itemId:e.id,parent:e.parent,ordering:e.position},success:function(t){var n=this.state.dataTree,a=n.get(e.id),r=n.get(e.parent);a.menuId="menu"==r.entity?e.parent:r.menuId,this.setState(function(t){t.dataTree[e.id]=a}),e.children&&e.children.length>0&&this.setChildMenuId(e),XE.toast("success","Item moved")}.bind(this)})},setChildMenuId:function(e){var t=this.state.dataTree;if(e.children&&e.children.length>0)for(var n=0,a=e.children.length;n<a;n+=1)if(t.indexes[e.id].node.menuId!==t.indexes[e.children[n]].node.menuId){var r=t.get(e.children[n]);r.menuId=t.indexes[e.id].node.menuId,this.setState(function(t,a){t.dataTree[e.children[n]]=r}),this.setChildMenuId(t.indexes[e.children[n]])}},getBaseUrl:function(){return this.props.baseUrl},onClickHome:function(e){var t=this.props.baseUrl+"/setHome",n=this.state.home,a=$("#uitree");this.setState({home:e.id}),XE.ajax({url:t,context:a,type:"put",dataType:"json",data:{itemId:e.id},success:function(t){XE.toast("success",e.title+" is home!")}.bind(this),error:function(e){XE.toast("error","home setting was failed!"),this.setState({home:n})}.bind(this)})},render:function(){return i.default.createElement("div",{className:"col-sm-12"},i.default.createElement("div",{className:"panel"},i.default.createElement(d.default,{tree:this.state.dataTree,handleSearch:this.setSearchedNode,menuRoutes:this.state.menuRoutes}),i.default.createElement("div",{className:"panel-body"},i.default.createElement(c.default,{paddingLeft:25,tree:this.state.dataTree,home:this.state.home,getBaseUrl:this.getBaseUrl,clickHome:this.onClickHome,getSearchedNode:this.getSearchedNode,setSearchedNode:this.setSearchedNode,getSelectedNode:this.getSelectedNode,setSelectedNode:this.setSelectedNode,moveNode:this.moveMenuItem}))))},isMenuEntity:function(e){return e.entity&&"menu"==e.entity}})},73:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(9),d=a(l),u=n(68),c=a(u),p=n(69),f=a(p),h=(0,o.default)({displayName:"TreeNode",propTypes:{index:d.default.object,tree:d.default.object,home:d.default.string,dragging:d.default.string,onDragStart:d.default.func,onCollapse:d.default.func,getBaseUrl:d.default.func,clickHome:d.default.func,getSelectedNode:d.default.func,setSelectedNode:d.default.func,getSearchedNode:d.default.func,setSearchedNode:d.default.func},renderChildren:function(){var e=this.props,t=e.index,n=e.tree,a=e.dragging,r=e.home,s=e.getBaseUrl,o=e.onDragStart,l=e.isDragging,d=t.id===a||this.props.isPlaceHolder;if(t.children&&t.children.length){var u={},c=t.children;if(t.collapsed){var p=e.getSearchedNode();null===p||t.id!=p.menuId?u.display="none":t.collapsed=!t.collapsed}var f=c.map(function(t){var u=n.getIndex(t);return i.default.createElement(h,{tree:n,index:u,key:u.id,dragging:a,home:r,onDragStart:o,isDragging:l,isPlaceHolder:d,clickHome:e.clickHome,getSelectedNode:e.getSelectedNode,setSelectedNode:e.setSelectedNode,getSearchedNode:e.getSearchedNode,setSearchedNode:e.setSearchedNode,getBaseUrl:s})});return i.default.createElement("div",{className:cx({"item-container":!0,move:l}),style:u},f)}return null},render:function(){var e=this.props,t=e.index,n=e.home,a=t.node,r=this.isPlaceHolder(e);return this.isMenuEntity(a)?i.default.createElement("div",{className:"menu-type"},i.default.createElement(c.default,{index:t,getBaseUrl:e.getBaseUrl,onCollapse:e.onCollapse}),this.renderChildren()):i.default.createElement("div",{className:cx({node:!0,item:!0,copy:r,off:1!==a.activated})},i.default.createElement(f.default,{index:t,home:n,getBaseUrl:e.getBaseUrl,clickHome:e.clickHome,mouseDown:this.handleMouseDown,getSelectedNode:e.getSelectedNode,setSelectedNode:e.setSelectedNode,getSearchedNode:e.getSearchedNode,setSearchedNode:e.setSearchedNode}),this.renderChildren())},handleMouseDown:function(e,t,n){this.props.onDragStart&&this.props.onDragStart(e,t,n)},isMenuEntity:function(e){return e.entity&&"menu"==e.entity},isPlaceHolder:function(e){var t=e.index,n=e.dragging;return t.id===n||e.isPlaceHolder}});t.default=h},74:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=a(r),s=n(7),o=a(s),l=n(9),d=a(l),u=n(73),c=a(u);t.default=(0,o.default)({displayName:"UITree",propTypes:{tree:d.default.object,home:d.default.string,paddingLeft:d.default.number,getBaseUrl:d.default.func,clickHome:d.default.func,getSelectedNode:d.default.func,setSelectedNode:d.default.func,getSearchedNode:d.default.func,setSearchedNode:d.default.func,moveNode:d.default.func},getDefaultProps:function(){return{paddingLeft:48}},getInitialState:function(){return this.init(this.props)},componentWillReceiveProps:function(e){this._update?this._update=!1:this.setState(this.init(e))},init:function(e){var t=e.tree;return t.updateNodesPosition(),{tempTree:null,tree:t,dragging:{id:null,x:null,y:null,w:null,h:null,originalParent:null,targetParent:null}}},getDraggingDom:function(){var e=this.state.tree,t=this.state.dragging,n=this.props.home;if(t&&t.id){var a=e.getIndex(t.id),r={top:t.y,left:t.x,width:t.w};return i.default.createElement("div",{className:"m-draggable move",style:r},i.default.createElement(c.default,{getBaseUrl:this.props.getBaseUrl,clickHome:this.props.clickHome,getSelectedNode:this.props.getSelectedNode,setSelectedNode:this.props.setSelectedNode,getSearchedNode:this.props.getSearchedNode,setSearchedNode:this.props.setSearchedNode,tree:e,home:n,index:a,key:t.id,isDragging:!0}))}return null},render:function(){var e=this.state.tree,t=this.state.dragging,n=this.getDraggingDom(),a=this,r=this.props.home,s=e.getIndex(0),o=s.children.map(function(n){return i.default.createElement(c.default,{tree:e,home:r,index:e.getIndex(n),getBaseUrl:a.props.getBaseUrl,clickHome:a.props.clickHome,getSelectedNode:a.props.getSelectedNode,setSelectedNode:a.props.setSelectedNode,getSearchedNode:a.props.getSearchedNode,setSearchedNode:a.props.setSearchedNode,key:n,onDragStart:a.dragStart,onCollapse:a.toggleCollapse,dragging:t&&t.id,isDragging:!1})});return i.default.createElement("div",{className:"menu-content",id:"uitree"},n,o)},dragStart:function(e,t,n){var a=this.state.tree,r=a.get(e);r.entity&&"menu"==r.entity||(this.setState({tempTree:new Tree(a.obj)}),this.dragging={id:e,w:t.offsetWidth,h:t.offsetHeight,x:t.offsetLeft,y:t.offsetTop,originalParent:a.get(e).parentId,targetParent:a.get(e).parentId,originalOrdering:a.get(e).ordering,lastOrdering:a.get(e).ordering},this._startX=t.offsetLeft,this._startY=t.offsetTop,this._offsetX=n.clientX,this._offsetY=n.clientY,this._start=!0,document.body.addEventListener("keydown",this.dragStop),document.body.addEventListener("mousemove",this.drag),document.body.addEventListener("mouseup",this.dragEnd))},drag:function(e){this._start&&(this.setState({dragging:this.dragging}),this._start=!1);var t=this.state.tree,n=this.state.dragging,a=this.props.paddingLeft,r=null,i=t.getIndex(n.id),s=i.collapsed,o=this._startX,l=this._startY,d=this._offsetX,u=this._offsetY,c={x:o+e.clientX-d,y:l+e.clientY-u};n.x=c.x,n.y=c.y;var p=n.x-a/2-(i.left-3)*a,f=n.y-n.h/2-(i.top-2)*n.h;if(2==i.depth&&p<0&&(p=0),p<0?i.parent&&!i.next&&(r=t.move(i.id,i.parent,"after")):p>a&&i.prev&&!t.getIndex(i.prev).collapsed&&(r=t.move(i.id,i.prev,"append")),r&&(i=r,r.collapsed=s,n.id=r.id),f<0){var h=t.getNodeByTop(i.top-1);r=t.move(i.id,h.id,"before")}else if(f>n.h){var m;i.next?(m=t.getIndex(i.next),r=m.children&&m.children.length&&!m.collapsed?t.move(i.id,i.next,"prepend"):t.move(i.id,i.next,"after")):(m=t.getNodeByTop(i.top+i.height))&&m.parent!==i.id&&(r=m.children&&m.children.length?t.move(i.id,m.id,"prepend"):t.move(i.id,m.id,"after"))}if(r){r.collapsed=s,n.id=r.id;var g=t.get(r.parent);n.targetParent=g.id,n.lastOrdering=r.ordering,n.children=r.children}this.setState({tree:t,dragging:n})},dragStop:function(e){var t={ENTER:13,TAB:9,BACKSPACE:8,UP_ARROW:38,DOWN_ARROW:40,ESCAPE:27};e.keyCode===t.ESCAPE&&e.preventDefault(),this.rollbackTree(),document.body.removeEventListener("mousemove",this.drag),document.body.removeEventListener("mouseup",this.dragEnd),document.body.removeEventListener("keydown",this.dragStop)},dragEnd:function(){this.setState({tempTree:null,dragging:{id:null,x:null,y:null,w:null,h:null,originalParent:null,targetParent:null}});var e=this.dragging;if(e.originalParent==e.targetParent){if(e.originalOrdering!=e.lastOrdering){var t=this.state.tree.get(e.id);"menu"!=t.entity&&this.props.moveNode({id:e.id,parent:e.targetParent,position:e.lastOrdering})}}else e.children.length>0?this.props.moveNode({id:e.id,parent:e.targetParent,position:e.lastOrdering,children:e.children}):this.props.moveNode({id:e.id,parent:e.targetParent,position:e.lastOrdering});document.body.removeEventListener("mousemove",this.drag),document.body.removeEventListener("mouseup",this.dragEnd),document.body.removeEventListener("keydown",this.dragStop)},rollbackTree:function(){var e=this.state.tempTree;if(e){var t=this.props;t.tree=e,this.setState(this.init(t)),this.setState({tree:e,dragging:{id:null,x:null,y:null,w:null,h:null,originalParent:null,targetParent:null}})}},toggleCollapse:function(e){var t=this.state.tree,n=t.getIndex(e),a=t.get(e);n.collapsed=!n.collapsed,a.collapsed=!a.collapsed,t.updateNodesPosition(),this.setState({tree:t})}})},9:function(e,t,n){e.exports=n(45)()}},[343]);